---
title: "Introduction à la science reproductible"
author: Marie-Pierre Etienne
institute: "https://github.com/MarieEtienne/reproductibilite"
date: "Septembre 2022"
csl: "../resources/apa-no-doi-no-issue.csl"
output:
   xaringan::moon_reader:
    css: [  'metropolis',  '../courses_tools/resources/mpe_pres.css']
    lib_dir: libs
    nature:
      ratio: 16:10
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      beforeInit: '../courses_tools/resources/collapseoutput.js'
    includes:
      after_body: '../courses_tools/resources/insert-logo.html'
---



```{r setup, include = FALSE,  eval = TRUE}
main_dir <-  '..'
common_img_dir <- file.path(main_dir,'courses_tools','resources', 'common_figs')
course_img_dir <- file.path(main_dir,'resources', 'figs')
BibOptions(check.entries = FALSE,
           bib.style = "authoryear",
           cite.style = "alphabetic",
           style = "markdown",
           hyperlink = FALSE,
           dashed = FALSE)
myBib <- ReadBib('bibliography.bib', check = FALSE)
with_sol <- TRUE ## in order to control the output
with_course <- TRUE
```





---
name: motiv
# Motivations

---
template: motiv

## La recherche reproductible


 Dans leur [papier](../resources/bes2.1801.pdf) `r Citet(myBib,'alston2021beginner')` font le point sur la question de la recherche reproductible en écologie.
 
 
 Ils identifient des  [Points clé](../resources/Bes2.1801_crop.pdf)


Les journaux scientifiques exigent de plus en plus de reproductibilité.

--

## En pratique

Une [vidéo](https://youtu.be/s3JldKoA0zw) de  [Ignasi Bartomeus](https://bartomeuslab.com/)  vaut mieux qu'un long discours 


--

## Objectif de ce cours 

Initier aux outils pour faciliter l'étape 2.


---

# Vue d'ensemble et panorama d'outils

## Le code 

.care[git] pour

- garder des traces des différentes versions du code
- pour travailler à plusieurs
- pour relire/amender le code des autres

--


## Autour du code 

- [Rmarkdown](https://rmarkdown.rstudio.com/) associe  du code R et du texte pour

  * des exemples d'utilisations, 
  * les fichiers d'aide de R, 
  * des articles, 
  * des dashboards ....
  
- Les [Jupyter notebooks](https://jupyter.org/)  permettent pour différents languages (Python, R, Julia, ...) 

 [Computo](https://computo.sfds.asso.fr/) réclame des contributions sous forme de Jupyter notebook ou Rmarkdown


--

## Figer/Gerer les versions de logiciel utilisés 

Pour assurer la reproductibilité, il ne suffit pas de s'assurer que le code a tourné une fois sur une machine avec succès.  


Le systeme de container [Docker](https://www.docker.com/) permet de figer un environnement sur lequel le programme fonctionne.

---

# Le trio gagnant de la recherche reproduction avec R

- .care[git]
- .care[Rmarkdown]
- Docker


---
name: gitintro
# Introduction à git

---
template: gitintro

## Qu'est ce que git ?

Linus Torvalds: *I'm an egotistical bastard, and I name all my projects after myself. First Linux, now [git](https://www.wordreference.com/enfr/git).*

--

Git est un système de contrôle de version (le plus largement utilisé aujourd'hui). Il permet de suivre l'ensemble des modifications apportées à un code depuis sa création.

Git est très performant.

Git n'est pas facile à apprendre et à maîtriser.



---
template: gitintro

## Graphiquement, sous forme d'arbre

<img src="https://illustrated-git.readthedocs.io/en/latest/_images/object-branch.svg" width="100" height = "900" alt = "simple branche"></img>


Cf example git_example avec la commande

```{r git_illustration, eval = FALSE}
git log
```



---
template: gitintro

## Cloner un repo distant

On va jouer avec ces fonctionnalités.


* Cloner le dépot qui va nous servir d'example, dans une console git taper la commande 

```{r git_clone, eval = FALSE}
ls   #commande qui liste le contenu d'un répertoire
git clone  nomdudepot # commande qui clone effectivement le repot distant
ls # on regarde ce qui est maintenant dans le repo
```

--

* Taper la commande `git log`
--

* Ouvrir le fichier `manchots.Rmd` et ajouter votre nom et la liste des auteurs et sauvegarder votre fichier . 
--

* Taper la commande `git log`
--

* Taper la commande `git status` 
--

* Taper la commande `git add manchots.Rmd` 
--

* Taper la commande `git status` 
--

* `git commit -m "Ajout d'un auteur"`

--

commit refusé car git n'est pas configuré : un commit c'est un photo de l'ensemble du projet ET un auteur

*  
```{r git_config, eval = FALSE}
git config --global user.email "votre adresse mail"
git config --global user.name "votre nom"`
git commit -m "Ajout d'un auteur"
git log 
git diff
git diff  origin/master
git push
git diff manchots.Rmd origin/master
```
 



---

# Références

```{r refs, echo=FALSE, results="asis", eval = TRUE, cache = FALSE}
PrintBibliography(myBib)
```
